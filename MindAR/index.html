<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR Camera Access</title>
  <script type="module">
    import { MindARThree } from 'https://cdn.jsdelivr.net/npm/mind-ar-js@1.2.5/dist/mindar-image-three.module.js';
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js';

    document.addEventListener('DOMContentLoaded', () => {
      const startButton = document.getElementById('startAR');
      const container = document.getElementById('ar-container');

      startButton.addEventListener('click', async () => {
        try {
          const mindar = new MindARThree({
            container,
            imageTargetSrc: 'https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/assets/targets.mind'
          });

          const { renderer, scene, camera } = mindar;

          renderer.setSize(container.clientWidth, container.clientHeight);
          renderer.setPixelRatio(window.devicePixelRatio);

          const geometry = new THREE.BoxGeometry(0.6, 0.6, 0.6);
          const material = new THREE.MeshNormalMaterial();
          const cube = new THREE.Mesh(geometry, material);

          const anchor = mindar.addAnchor(0);
          anchor.group.add(cube);

          anchor.onTargetFound = () => console.log('Target found');
          anchor.onTargetLost = () => console.log('Target lost');

          await mindar.start();

          renderer.setAnimationLoop(() => {
            cube.rotation.y += 0.02;
            renderer.render(scene, camera);
          });

          startButton.style.display = 'none';
        } catch (err) {
          console.error('Error starting AR:', err);
        }
      });
    });
  </script>
</head>
<body>
  <button id="startAR">Start AR</button>
  <div id="ar-container" style="width: 100vw; height: 100vh;"></div>
</body>
</html>
